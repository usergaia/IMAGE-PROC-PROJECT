# Image Segmentation and Background Replacement

This script performs image segmentation using various techniques, including edge detection, morphological operations, and K-means clustering. It extracts the object of interest from an image and replaces the background with a simple gradient. The final result includes the original image, intermediate masks, the extracted object, and the result with the new background.

---

## Execution Flow

### **Step 1: Read and Resize Image**
- The script begins by reading the input image and resizing it to **512x512 pixels** to standardize the input size.

### **Step 2: Apply Canny Edge Detection and Morphological Gradient**
- The image is converted to grayscale, and the **Canny edge detection algorithm** is applied to find edges in the image.
- A **morphological gradient** is applied to enhance the edges by performing dilation and then erosion. This is calculated as:
  
  ```plaintext
     Morphological Gradient = Dilation - Erosion
  ```
    
### **Step 3: Create Initial Mask and Remove Noise**
- The edges are filled to create an initial mask, followed by morphological operations like **closing, opening, and hole filling** to refine the mask and remove noise.
- The mask is further refined by retaining only the **largest object** in the image.

### **Step 4: Apply K-means Clustering on the Masked Region**
- **K-means clustering** is applied to the pixels inside the initial mask to distinguish the object of interest from the rest of the image. This step clusters the pixels into two groups: the object and the background.
- The mask is then updated based on the **larger cluster**, which is assumed to correspond to the object.

### **Step 5: Combine Initial and K-means Masks for Final Refinement**
- The final mask is generated by combining the results from the **initial mask** and the **K-means clustering**. Further refinement is done by closing gaps, filling holes, and removing small objects.
- Only the **largest connected component** is kept for the final mask.

### **Step 6: Extract Object Using Final Mask**
- The object of interest is extracted from the image using the final mask. This is done by multiplying the image with the final mask to retain only the pixels corresponding to the object.

### **Step 7: Create Simple Gradient Background**
- A **gradient background** is generated based on the dimensions of the image, with values assigned to the red, green, and blue channels to create a smooth gradient effect. *(placeholder)*
- The object is combined with the new background by replacing the original background with the generated gradient.

### **Step 8: Display Results** *(placeholder)*
- The script displays several images for comparison:
1. The **original image**.
2. The **initial mask**.
3. The **K-means mask**.
4. The **extracted object**.
5. The **final result** with the new background.

### **Step 9: Object Detection (To Do)**
- Placeholder for future **object detection** functionality.

---

## Requirements

- **MATLAB** or **VSCode** (with the MATLAB Extension and the Statistics and Machine Learning add-ons installed).
- Image files (e.g., `input.jpg`) located in the `images/` directory.
